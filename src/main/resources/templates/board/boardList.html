<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/layout.html}">
<head>
  <title layout:fragment="title">Board</title>
  <link layout:fragment="css" rel="stylesheet" th:href="@{/css/boardList.css}">
</head>
<body>
<div layout:fragment="content" class="content">
  <div class="board-header">
    <button class="board-header-register">
      <a th:href="@{/board/register}">작성하기</a>
    </button>
    <h1 class="board-header-title">게시판</h1></div>
  <div class="board-container" th:each="board : ${boards}">
    <div class="board-left">
      <div class="board-user">
        <p th:text="${board.name}">이름</p>
        <p
          class="board-user-createDate"
          th:text="${#temporals.format(board.createDate, 'yyyy-MM-dd')}"
          th:data-createDate="${board.createDate}"></p>
      </div>
      <div class="board-title">
        <a
          th:text="${board.title}"
          th:href="@{/board/{boardId} (boardId=${board.id})}">글제목
        </a>
      </div>
      <div class="board-category">
        <span th:text="${board.categoryName}">카테고리</span>
      </div>
    </div>
    <div class="board-right">
      <span th:text="'조회수 ' + ${board.viewCnt}">조회수</span>
      <span>댓글 0</span>
      <span th:text="'추천수 ' + ${board.recommendCnt}">추천수</span>
    </div>
  </div>
  <script>
		const now = new Date();
		const createDateElements = document.querySelectorAll('.board-user-createDate');
		createDateElements.forEach(e => {
			const createDate = new Date(e.getAttribute('data-createDate'));
			const diff = now - createDate;
			const diffMinutes = Math.floor(diff / (1000 * 60));
			let diffMessage = ''
			if (diffMinutes < 60) {
				if (diffMinutes == 0) {
					diffMessage = '방금 전'
				} else {
					diffMessage = diffMinutes + '분 전';
        }
			} else if (diffMinutes < 60 * 24) {
				diffMessage = Math.floor(diffMinutes / 60) + '시간 전';
			} else {
				diffMessage = Math.floor(diffMinutes / (60 * 24)) + '일 전';
			}
			e.innerHTML = e.innerHTML + '  ' + diffMessage;
		})
  </script>
</div>
</body>
</html>